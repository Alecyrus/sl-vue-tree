!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SlVueTree=t():e.SlVueTree=t()}(window,function(){return function(e){var t={};function o(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);var i={name:"sl-vue-tree",props:{value:{type:Array,default:()=>[]},edgeSize:{type:Number,default:3},showBranches:{type:Boolean,default:!1},level:{type:Number,default:0},parentInd:{type:Number},allowMultiselect:{type:Boolean,default:!0}},data:()=>({rootCursorPosition:null,rootDraggingNode:null}),computed:{cursorPosition(){return this.isRoot?this.rootCursorPosition:this.getParent().cursorPosition},draggingNode(){return this.isRoot?this.rootDraggingNode:this.getParent().draggingNode},nodes(){if(this.isRoot){const e=this.copy(this.value);return this.getNodes(e)}return this.getParent().nodes[this.parentInd].children},gaps(){const e=[];let t=this.level-1;for(this.showBranches||t++;t-- >0;)e.push(t);return e},isRoot(){return!this.level}},methods:{setDraggingNode(e){this.isRoot?this.rootDraggingNode=e:this.getParent().setDraggingNode(e)},setCursorPosition(e){this.isRoot?this.rootCursorPosition=e:this.getParent().setCursorPosition(e)},getNodes(e,t=[]){return e.map((o,i)=>{const r=t.concat(i);return this.getNode(r,o,e)})},getNode(e,t=null,o=null){const i=e.slice(-1)[0];return o=o||this.getNodeSiblings(this.value,e),{title:(t=t||o[i]).title,isLeaf:!!t.isLeaf,children:t.children?this.getNodes(t.children,e):[],isExpanded:void 0==t.isExpanded||!!t.isExpanded,isSelected:!!t.isSelected,data:void 0!==t.data?t.data:{},path:e,pathStr:JSON.stringify(e),ind:i,isFirstChild:0==i,isLastChild:i===o.length-1}},emitInput(e){this.getRoot().$emit("input",e)},emitSelect(e,t){this.getRoot().$emit("select",e,t)},emitDrop(e,t,o){this.getRoot().$emit("drop",e,t,o)},emitToggle(e,t){this.getRoot().$emit("toggle",e,t)},emitNodeDblclick(e,t){this.getRoot().$emit("nodedblclick",e,t)},emitNodeContextmenu(e,t){this.getRoot().$emit("nodecontextmenu",e,t)},emitNodeclick(e,t){this.getRoot().$emit("nodeclick",e,t)},emitDragleave(e,t,o){this.getRoot().$emit("dragleave",e,t,o)},onDragleaveHandler(e,t){const o=this.getRoot().$el;e.clientY>o.offsetTop+o.offsetHeight?this.emitDragleave(t,"bottom",e):e.clientY<o.offsetTop&&this.emitDragleave(t,"top",e)},onNodeClickHandler(e,t){if(!this.isRoot)return void this.getRoot().onNodeClickHandler(e,t);const o=this.copy(this.value);this.traverse((o,i)=>{o.pathStr===t.pathStr?i.isSelected=!0:e.ctrlKey&&this.allowMultiselect||i.isSelected&&(i.isSelected=!1)},o),this.emitInput(o),this.emitSelect(t,e),this.emitNodeclick(t,e)},onNodeDragoverHandler(e,t){if(!this.draggingNode)return;const o=e.currentTarget.offsetHeight,i=this.edgeSize,r=e.offsetY;let s;s=t.isLeaf?r>=o/2?"after":"before":r<=i?"before":r>=o-i?"after":"inside",this.setCursorPosition({node:t,placement:s}),this.checkNodeIsParent(this.draggingNode,this.cursorPosition.node)||e.preventDefault()},onNodeDropHandler(e,t){},onNodeDragstartHandler(e,t){this.setDraggingNode(t)},onNodeDragendHandler(e,t){if(!this.isRoot)return void this.getParent().onNodeDragendHandler(e,t);if(this.checkNodeIsParent(this.draggingNode,this.cursorPosition.node))return void this.stopDrag();const o=this.copy(this.value),i=this.getNodeSiblings(o,this.draggingNode.path)[this.draggingNode.ind],r=this.copy(i);i._markToDelete=!0;const s=this.cursorPosition.node,n=this.getNodeSiblings(o,s.path),a=n[s.ind];if("inside"==this.cursorPosition.placement)a.children=a.children||[],a.children.unshift(r);else{const e="before"===this.cursorPosition.placement?s.ind:s.ind+1;n.splice(e,0,r)}this.traverse((e,t,o)=>{if(!t._markToDelete)return!0;const i=e.ind;return o.splice(i,1),!1},o),this.emitInput(o),this.emitDrop(this.draggingNode,this.cursorPosition,e),this.stopDrag()},onToggleHandler(e,t){this.updateNode(t,{isExpanded:!t.isExpanded}),this.emitToggle(t,e),e.stopPropagation()},stopDrag(){this.setDraggingNode(null),this.setCursorPosition(null)},getParent(){return this.$parent},getRoot(){return this.isRoot?this:this.getParent().getRoot()},getNodeSiblings(e,t){return 1===t.length?e:this.getNodeSiblings(e[t[0]].children,t.slice(1))},updateNode(e,t){if(!this.isRoot)return void this.getParent().updateNode(e,t);const o=this.copy(this.value);this.traverse((o,i)=>{o.pathStr===e.pathStr&&Object.assign(i,t)},o),this.emitInput(o)},getSelected(){const e=[];return this.traverse(t=>{t.isSelected&&e.push(t)}),e},traverse(e,t=null,o=[]){t||(t=this.value);let i=!1;const r=[];return t.forEach((s,n)=>{const a=o.concat(n),l=this.getNode(a,s,t);if(i=!1===e(l,s,t),r.push(l),i)return!1;s.children&&(i=!1===this.traverse(e,s.children,a))}),!i&&r},checkNodeIsParent(e,t){const o=t.path;return JSON.stringify(o.slice(0,e.path.length))==e.pathStr},copy:e=>JSON.parse(JSON.stringify(e))}},r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"sl-vue-tree",class:{"sl-vue-tree-root":e.isRoot}},e._l(e.nodes,function(t,i){return o("div",{staticClass:"sl-vue-tree-node",class:{"sl-vue-tree-selected":t.isSelected}},[o("div",{directives:[{name:"show",rawName:"v-show",value:e.cursorPosition&&e.cursorPosition.node.pathStr===t.pathStr&&"before"===e.cursorPosition.placement,expression:"\n        cursorPosition &&\n        cursorPosition.node.pathStr === node.pathStr &&\n        cursorPosition.placement === 'before'\n      "}],staticClass:"sl-vue-tree-cursor sl-vue-tree-cursor_before"}),e._v(" "),o("div",{staticClass:"sl-vue-tree-node-item",class:{"sl-vue-tree-cursor-inside":e.cursorPosition&&"inside"===e.cursorPosition.placement&&e.cursorPosition.node.pathStr===t.pathStr,"sl-vue-tree-node-is-leaf":t.isLeaf,"sl-vue-tree-node-is-folder":!t.isLeaf},attrs:{draggable:"true"},on:{dragover:function(o){return e.onNodeDragoverHandler(o,t)},drop:function(o){return e.onNodeDropHandler(o,t)},dragstart:function(o){return e.onNodeDragstartHandler(o,t)},dragend:function(o){return e.onNodeDragendHandler(o,t)},click:function(o){return e.onNodeClickHandler(o,t)},contextmenu:function(o){return e.emitNodeContextmenu(t,o)},dblclick:function(o){return e.emitNodeDblclick(t,o)},dragleave:function(o){return e.onDragleaveHandler(o,t)}}},[e._l(e.gaps,function(e){return o("div",{staticClass:"sl-vue-tree-gap"})}),e._v(" "),e.level&&e.showBranches?o("div",{staticClass:"sl-vue-tree-branch"},[e._t("branch",[t.isLastChild?e._e():o("span",[e._v("\n            "+e._s(String.fromCharCode(9500))+e._s(String.fromCharCode(9472))+" \n          ")]),e._v(" "),t.isLastChild?o("span",[e._v("\n            "+e._s(String.fromCharCode(9492))+e._s(String.fromCharCode(9472))+" \n          ")]):e._e()],{node:t})],2):e._e(),e._v(" "),o("div",{staticClass:"sl-vue-tree-title"},[t.isLeaf?e._e():o("span",{staticClass:"sl-vue-tree-toggle",on:{click:function(o){return e.onToggleHandler(o,t)}}},[e._t("toggle",[o("span",[e._v("\n             "+e._s(t.isLeaf?"":t.isExpanded?"-":"+")+"\n            ")])],{node:t})],2),e._v(" "),e._t("title",[e._v(e._s(t.title))],{node:t})],2),e._v(" "),o("div",{staticClass:"sl-vue-tree-sidebar"},[e._t("sidebar",null,{node:t})],2)],2),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.cursorPosition&&e.cursorPosition.node.pathStr===t.pathStr&&"after"===e.cursorPosition.placement,expression:"\n        cursorPosition &&\n        cursorPosition.node.pathStr === node.pathStr &&\n        cursorPosition.placement === 'after'\n      "}],staticClass:"sl-vue-tree-cursor sl-vue-tree-cursor_after"}),e._v(" "),t.children&&t.children.length&&t.isExpanded?o("sl-vue-tree",{attrs:{value:t.children,level:e.level+1,parentInd:i,allowMultiselect:e.allowMultiselect,edgeSize:e.edgeSize,showBranches:e.showBranches},scopedSlots:e._u([{key:"title",fn:function(t){var o=t.node;return[e._t("title",[e._v(e._s(o.title))],{node:o})]}},{key:"toggle",fn:function(t){var i=t.node;return[e._t("toggle",[o("span",[e._v("\n             "+e._s(i.isLeaf?"":i.isExpanded?"-":"+")+"\n          ")])],{node:i})]}},{key:"sidebar",fn:function(t){var o=t.node;return[e._t("sidebar",null,{node:o})]}}])}):e._e()],1)}))};r._withStripped=!0;var s=function(e,t,o,i,r,s,n,a){var l=typeof(e=e||{}).default;"object"!==l&&"function"!==l||(e=e.default);var d,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=o,c._compiled=!0),i&&(c.functional=!0),s&&(c._scopeId=s),n?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},c._ssrRegister=d):r&&(d=a?function(){r.call(this,this.$root.$options.shadowRoot)}:r),d)if(c.functional){c._injectStyles=d;var u=c.render;c.render=function(e,t){return d.call(t),u(e,t)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,d):[d]}return{exports:e,options:c}}(i,r,[],!1,null,null,null);s.options.__file="src\\sl-vue-tree.vue";t.default=s.exports}]).default});
//# sourceMappingURL=sl-vue-tree.js.map